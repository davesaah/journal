import{c as w,r as u,m as X,a as m,f as n,b as l,w as p,u as s,j as v,L as E,F as Y,n as Z,i as ee,p as C,q as te,s as ae,v as se,d as ne,o as i,k as h,x as b,t as H,h as I}from"./index-DrZWanCR.js";import{a as M,_ as oe}from"./Label-BnX8t1h9.js";import{_ as le,d as z,a as re,A as ie,B as de,I as ce,H as ue,b as me,L as pe,c as fe,e as ve,Q as xe}from"./_plugin-vue_export-helper-CqDjgvqD.js";import"./index-CK0k7uqp.js";const ge=w("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const he=w("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const be=w("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),we={class:"container max-w-6xl mx-auto py-6 md:py-8 px-4 h-full md:h-[calc(100vh-2rem)] flex flex-col"},ye={class:"flex justify-between items-center mb-6"},_e={class:"flex gap-2"},ke={class:"hidden md:inline"},Le={key:0,class:"flex-1 flex flex-col items-center justify-center"},Se={key:1,class:"space-y-4 flex-1 flex flex-col overflow-hidden animate-in fade-in duration-500"},Ve={class:"grid gap-2 mb-2"},Be={class:"flex items-center gap-2 text-muted-foreground/60 border-b border-primary/5 pb-2"},Ee={class:"flex flex-col min-h-[400px] md:min-h-0 overflow-hidden"},Ce={class:"flex flex-wrap gap-1 mb-4 p-1.5 border rounded-xl bg-muted/20 backdrop-blur-sm border-primary/5 sticky top-0 z-10"},He={key:0,class:"flex flex-col overflow-hidden pb-12 md:pb-0"},Ie=["innerHTML"],Me={__name:"EditorView",setup(ze){const x=te(),y=ne(),{addEntry:D,getEntry:O,updateEntry:T,loading:_}=ae(),g=u(!1),k=u(null),d=u(!0),c=u(!1),j=[{icon:de,handler:()=>A(),label:"Bold"},{icon:ce,handler:()=>F(),label:"Italic"},{icon:ue,handler:()=>R(),label:"Heading 1"},{icon:me,handler:()=>U(),label:"Heading 2"},{icon:pe,handler:()=>J(),label:"Bullet List"},{icon:fe,handler:()=>q(),label:"Numbered List"},{icon:ve,handler:()=>G(),label:"Link"},{icon:xe,handler:()=>K(),label:"Quote"}],t=u({title:"",content:"",created_at:new Date().toISOString().slice(0,16)});z.setOptions({breaks:!0,gfm:!0});const N=se(()=>t.value.content?z(t.value.content):'<p class="text-muted-foreground">Start writing to see the preview...</p>');X(async()=>{if(x.params.id){g.value=!0,k.value=x.params.id;const o=O(x.params.id);o&&(t.value={...o,created_at:o.created_at?new Date(o.created_at).toISOString().slice(0,16):new Date().toISOString().slice(0,16)})}});const P=async()=>{if(!t.value.content.trim())return;c.value=!0;let o;const e={title:t.value.title,content:t.value.content,created_at:new Date(t.value.created_at).toISOString()};g.value?o=await T(k.value,e):o=await D(e),c.value=!1,o.success&&y.push("/")},Q=()=>{y.back()},$=()=>{d.value=!d.value},r=(o,e="")=>{const a=document.getElementById("content-editor");if(!a)return;const f=a.selectionStart,L=a.selectionEnd,S=t.value.content.substring(f,L),V=o+S+e,W=t.value.content.substring(0,f)+V+t.value.content.substring(L);t.value.content=W,setTimeout(()=>{const B=S?f+V.length:f+o.length;a.focus(),a.setSelectionRange(B,B)},0)},A=()=>r("**","**"),F=()=>r("*","*"),R=()=>r("# "),U=()=>r("## "),J=()=>r("- "),q=()=>r("1. "),G=()=>r("[","](url)"),K=()=>r("> ");return(o,e)=>(i(),m("div",we,[n("header",ye,[l(s(v),{variant:"ghost",onClick:Q,class:"gap-2 pl-0 hover:pl-2 transition-all group"},{default:p(()=>[l(s(ie),{class:"w-4 h-4 group-hover:-translate-x-1 transition-transform"}),e[3]||(e[3]=n("span",{class:"hidden sm:inline"},"Back to Journal",-1)),e[4]||(e[4]=n("span",{class:"sm:hidden text-sm uppercase tracking-widest font-bold"},"Back",-1))]),_:1}),n("div",_e,[l(s(v),{variant:"outline",onClick:$,class:"gap-2 h-10 md:h-11",size:"sm"},{default:p(()=>[(i(),h(b(d.value?s(ge):s(he)),{class:"w-4 h-4"})),n("span",ke,H(d.value?"Hide":"Show")+" Preview",1)]),_:1}),l(s(v),{onClick:P,class:"gap-2 shadow-lg shadow-primary/20 h-10 md:h-11 px-4 md:px-6",disabled:c.value||s(_)},{default:p(()=>[(i(),h(b(c.value?s(E):s(be)),{class:C(["w-4 h-4",c.value?"animate-spin":""])},null,8,["class"])),I(" "+H(c.value?"Saving...":"Save"),1)]),_:1},8,["disabled"])])]),s(_)&&g.value&&!t.value.title?(i(),m("div",Le,[l(s(E),{class:"w-10 h-10 text-primary animate-spin mb-4"}),e[5]||(e[5]=n("p",{class:"text-muted-foreground"},"Fetching your entry...",-1))])):(i(),m("div",Se,[n("div",Ve,[l(s(M),{modelValue:t.value.title,"onUpdate:modelValue":e[0]||(e[0]=a=>t.value.title=a),placeholder:"Entry Title",class:"text-2xl md:text-3xl font-bold border-none px-0 shadow-none focus-visible:ring-0 placeholder:text-muted-foreground/30 h-auto py-2 bg-transparent"},null,8,["modelValue"]),n("div",Be,[l(s(oe),{for:"date",class:"sr-only"},{default:p(()=>[...e[6]||(e[6]=[I("Date",-1)])]),_:1}),l(s(M),{id:"date",type:"datetime-local",modelValue:t.value.created_at,"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.created_at=a),class:"w-auto border-none shadow-none px-0 focus-visible:ring-0 text-xs md:text-sm h-8 bg-transparent"},null,8,["modelValue"])])]),n("div",{class:C(["flex-1 grid gap-8 overflow-y-auto md:overflow-hidden pb-8 md:pb-0",d.value?"md:grid-cols-2":"grid-cols-1"])},[n("div",Ee,[e[7]||(e[7]=n("div",{class:"flex items-center justify-between mb-2 px-2"},[n("span",{class:"text-[10px] md:text-xs font-bold uppercase tracking-wider text-muted-foreground/50"},"Editor (Markdown)")],-1)),n("div",Ce,[(i(),m(Y,null,Z(j,a=>l(s(v),{key:a.label,variant:"ghost",size:"sm",onClick:a.handler,class:"h-9 w-9 p-0 hover:bg-primary/10 hover:text-primary transition-colors",title:a.label},{default:p(()=>[(i(),h(b(a.icon),{class:"w-4 h-4 md:w-4.5 md:h-4.5"}))]),_:2},1032,["onClick","title"])),64))]),l(s(re),{id:"content-editor",modelValue:t.value.content,"onUpdate:modelValue":e[2]||(e[2]=a=>t.value.content=a),placeholder:"Start writing your thoughts...",class:"flex-1 resize-none border-none rounded-2xl p-5 md:p-6 focus-visible:ring-1 focus-visible:ring-primary/20 text-base md:text-lg leading-relaxed bg-muted/10 min-h-[300px] md:min-h-0"},null,8,["modelValue"])]),d.value?(i(),m("div",He,[e[8]||(e[8]=n("div",{class:"text-[10px] md:text-xs font-bold uppercase tracking-wider text-muted-foreground/50 mb-2 px-2"},"Preview",-1)),n("div",{class:"flex-1 border border-primary/5 rounded-2xl p-6 md:p-8 overflow-auto prose prose-lg dark:prose-invert max-w-none bg-card/30 backdrop-blur-sm shadow-inner",innerHTML:N.value},null,8,Ie)])):ee("",!0)],2)]))]))}},Ne=le(Me,[["__scopeId","data-v-3b20d432"]]);export{Ne as default};
