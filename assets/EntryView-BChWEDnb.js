import{c as M,a as m,f as t,b as l,w as c,u as a,j as x,k as v,i as k,t as y,p as T,h as b,F as D,n as V,G as j,H as A,L as I,v as L,r as N,s as Y,q as W,d as X,o as r,_ as Z,x as $}from"./index-DrZWanCR.js";import{_ as ee,d as H,a as te,A as z,B as se,I as ae,H as oe,b as re,L as ne,c as le,e as ie,Q as de}from"./_plugin-vue_export-helper-CqDjgvqD.js";import{_ as ue}from"./CardContent-BlPn3EAX.js";import"./index-CK0k7uqp.js";const me=M("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);const ce=M("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);const fe=M("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),pe={key:0,class:"container max-w-4xl mx-auto py-6 md:py-12 px-4 animate-in fade-in duration-700"},ge={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8 md:mb-12"},he={class:"mb-12 md:mb-16"},xe={class:"space-y-4 md:space-y-6 mb-8 md:mb-10"},be={class:"flex flex-col md:flex-row md:items-start justify-between gap-4"},ve={class:"text-3xl sm:text-4xl md:text-5xl font-extrabold tracking-tight leading-tight flex-1 bg-clip-text text-transparent bg-gradient-to-br from-foreground to-foreground/70"},ye={class:"flex items-center gap-2 text-muted-foreground font-medium text-sm md:text-base"},we=["innerHTML"],_e={class:"border-t border-primary/10 pt-8 md:pt-12 pb-12"},ke={class:"flex items-center gap-3 mb-6 md:mb-8"},Le={class:"p-2 rounded-lg bg-primary/10"},He={key:0,class:"space-y-4 md:space-y-6 mb-8 md:mb-10"},Me=["innerHTML"],Be={class:"flex items-center gap-2 mt-4 text-[10px] font-bold uppercase tracking-widest text-muted-foreground/40"},Ce={key:1,class:"space-y-4 animate-in slide-in-from-bottom-4 duration-500"},Ee={class:"flex flex-wrap gap-1 p-1.5 border border-primary/5 rounded-xl bg-muted/20 backdrop-blur-sm"},Te={class:"flex flex-col sm:flex-row justify-between items-center gap-4"},De={key:2,class:"text-center py-12 text-muted-foreground/40 italic text-sm"},Ve={key:1,class:"flex flex-col items-center justify-center min-h-[70vh] p-4 text-center"},je={key:2,class:"flex flex-col items-center justify-center min-h-[70vh] text-center space-y-6 p-4"},Ae={class:"p-6 rounded-full bg-destructive/5 text-destructive"},Ie={__name:"EntryView",setup(Ne){const Q=W(),B=X(),{getEntry:R,addAfterthought:S,isOwnEntry:F,loading:q}=Y(),o=L(()=>R(Q.params.id)),i=N(""),f=N(!1),w=L(()=>o.value&&F(o.value));H.setOptions({breaks:!0,gfm:!0});const J=L(()=>o.value?.content?H(o.value.content):""),K=n=>{if(!n)return"";const e={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(n).toLocaleDateString(void 0,e)},O=n=>{if(!n)return"";const e=new Date(n),s=new Date,u=s-e,p=Math.floor(u/6e4),g=Math.floor(u/36e5),h=Math.floor(u/84e5);return p<1?"just now":p<60?`${p}m ago`:g<24?`${g}h ago`:h<7?`${h}d ago`:new Date(n).toLocaleDateString(void 0,{month:"short",day:"numeric",year:e.getFullYear()!==s.getFullYear()?"numeric":void 0})},C=()=>{B.push("/")},G=()=>{B.push(`/edit/${o.value.id}`)},_=async()=>{if(!i.value.trim()||f.value)return;f.value=!0,(await S(o.value.id,i.value.trim())).success&&(i.value=""),f.value=!1},d=(n,e="")=>{const s=document.getElementById("afterthought-editor");if(!s)return;const u=s.selectionStart,p=s.selectionEnd,g=i.value.substring(u,p),h=n+g+e,U=i.value.substring(0,u)+h+i.value.substring(p);i.value=U,setTimeout(()=>{const E=g?u+h.length:u+n.length;s.focus(),s.setSelectionRange(E,E)},0)},P=[{icon:se,handler:()=>d("**","**"),label:"Bold"},{icon:ae,handler:()=>d("*","*"),label:"Italic"},{icon:oe,handler:()=>d("# "),label:"Heading 1"},{icon:re,handler:()=>d("## "),label:"Heading 2"},{icon:ne,handler:()=>d("- "),label:"Bullet List"},{icon:le,handler:()=>d("1. "),label:"Numbered List"},{icon:ie,handler:()=>d("[","](url)"),label:"Link"},{icon:de,handler:()=>d("> "),label:"Quote"}];return(n,e)=>o.value?(r(),m("div",pe,[t("header",ge,[l(a(x),{variant:"ghost",onClick:C,class:"gap-2 pl-0 hover:pl-2 transition-all group"},{default:c(()=>[l(a(z),{class:"w-4 h-4 group-hover:-translate-x-1 transition-transform"}),e[1]||(e[1]=b(" Back to Journal ",-1))]),_:1}),w.value?(r(),v(a(x),{key:0,variant:"outline",onClick:G,class:"w-full sm:w-auto gap-2 border-primary/20 hover:bg-primary/5 shadow-sm h-10 md:h-11"},{default:c(()=>[l(a(ce),{class:"w-4 h-4"}),e[2]||(e[2]=b(" Edit Entry ",-1))]),_:1})):k("",!0)]),t("article",he,[t("div",xe,[t("div",be,[t("h1",ve,y(o.value.title||"Untitled Entry"),1),t("span",{class:T(["self-start text-[10px] uppercase tracking-widest px-3 py-1 rounded-full font-bold border",w.value?"bg-primary/10 text-primary border-primary/20 shadow-sm shadow-primary/5":"bg-muted text-muted-foreground border-transparent"])},y(o.value.author_name||"Anonymous"),3)]),t("time",ye,[e[3]||(e[3]=t("span",{class:"w-1.5 h-1.5 rounded-full bg-primary"},null,-1)),b(" "+y(K(o.value.created_at)),1)])]),t("div",{class:"prose prose-lg md:prose-xl dark:prose-invert max-w-none leading-relaxed text-foreground/90 selection:bg-primary/20 break-words",innerHTML:J.value},null,8,we)]),t("section",_e,[t("div",ke,[t("div",Le,[l(a(me),{class:"w-5 h-5 text-primary"})]),e[4]||(e[4]=t("h2",{class:"text-xl md:text-2xl font-bold tracking-tight"},"AfterThoughts",-1))]),o.value.afterthoughts&&o.value.afterthoughts.length>0?(r(),m("div",He,[(r(!0),m(D,null,V(o.value.afterthoughts,s=>(r(),v(a(Z),{key:s.id,class:"border-none bg-muted/30 backdrop-blur-sm relative overflow-hidden group hover:bg-muted/40 transition-colors"},{default:c(()=>[e[5]||(e[5]=t("div",{class:"absolute left-0 top-0 bottom-0 w-1 bg-primary/30 group-hover:bg-primary transition-colors"},null,-1)),l(a(ue),{class:"py-4 px-6 md:py-6 md:px-8"},{default:c(()=>[t("div",{class:"prose md:prose-lg dark:prose-invert max-w-none text-foreground/80 leading-relaxed italic text-sm md:text-base",innerHTML:a(H)(s.content)},null,8,Me),t("div",Be,[t("span",null,"â€” "+y(O(s.created_at)),1)])]),_:2},1024)]),_:2},1024))),128))])):k("",!0),w.value?(r(),m("div",Ce,[t("div",Ee,[(r(),m(D,null,V(P,s=>l(a(x),{key:s.label,variant:"ghost",size:"sm",onClick:s.handler,class:"h-9 w-9 p-0 hover:bg-primary/10 hover:text-primary transition-colors",title:s.label},{default:c(()=>[(r(),v($(s.icon),{class:"w-4 h-4"}))]),_:2},1032,["onClick","title"])),64))]),l(a(te),{id:"afterthought-editor",modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=s=>i.value=s),placeholder:"Reflect on this entry...",class:"min-h-[120px] resize-none font-sans text-base md:text-lg border-none focus-visible:ring-1 focus-visible:ring-primary/20 bg-muted/10 rounded-2xl p-5 md:p-6",onKeydown:[j(A(_,["ctrl"]),["enter"]),j(A(_,["meta"]),["enter"])]},null,8,["modelValue","onKeydown"]),t("div",Te,[e[7]||(e[7]=t("p",{class:"hidden sm:block text-xs font-medium text-muted-foreground/50 italic px-2"},"Ctrl + Enter to submit",-1)),l(a(x),{onClick:_,class:"w-full sm:w-auto gap-2 px-8 h-12 rounded-full shadow-lg shadow-primary/10 font-bold",disabled:!i.value.trim()||f.value},{default:c(()=>[(r(),v($(f.value?a(I):a(fe)),{class:T(["w-4 h-4",f.value?"animate-spin":""])},null,8,["class"])),e[6]||(e[6]=b(" Add Thought ",-1))]),_:1},8,["disabled"])])])):!o.value.afterthoughts||o.value.afterthoughts.length===0?(r(),m("div",De," No afterthoughts have been shared yet. ")):k("",!0)])])):a(q)?(r(),m("div",Ve,[l(a(I),{class:"w-12 h-12 text-primary animate-spin mb-4"}),e[8]||(e[8]=t("p",{class:"text-muted-foreground animate-pulse"},"Gathering memories...",-1))])):(r(),m("div",je,[t("div",Ae,[l(a(z),{class:"w-12 h-12"})]),e[10]||(e[10]=t("div",{class:"space-y-2"},[t("h3",{class:"text-xl md:text-2xl font-bold"},"Entry not found"),t("p",{class:"text-muted-foreground text-sm md:text-base"},"The entry you're looking for might have been removed or moved.")],-1)),l(a(x),{size:"lg",onClick:C,variant:"outline",class:"w-full sm:w-auto px-8"},{default:c(()=>[...e[9]||(e[9]=[b("Return to Journal",-1)])]),_:1})]))}},Ue=ee(Ie,[["__scopeId","data-v-b947af1a"]]);export{Ue as default};
